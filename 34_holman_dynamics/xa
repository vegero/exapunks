LINK 800
LINK 802
LINK 799
GRAB 199
JUMP FIND16

MARK RECV
MAKE
@REP 16
COPY M F
@END
LINK -1
SEEK -9999
COPY 0 X
JUMP ASSERTLOOP

MARK FIND16
TEST F > -1
ADDI X 1 X
FJMP CHECK16
TEST EOF
TJMP CHECK16
JUMP FIND16

MARK CHECK16
TEST X < 17
TJMP NEXT16
MULI X -1 T
SEEK T
SUBI X 15 X
MARK SEND
REPL RECV
@REP 16
COPY F M
@END
SUBI X 1 X
TEST X = 0
TJMP FINISH16
SEEK -15
JUMP SEND

MARK FINISH16
JUMP FIND16

MARK NEXT16
COPY 0 X
JUMP FIND16

MARK ASSERTLOOP
TEST EOF
TJMP CHECKVALID
MULI F 2 T
TEST T > 9
SEEK -1
TJMP TOOBIG
MULI F 2 T
ADDI T X X
MARK ASSERTEVEN
ADDI F X X
JUMP ASSERTLOOP

MARK TOOBIG
MULI F 2 T
SUBI T 9 T
ADDI T X X
JUMP ASSERTEVEN

MARK CHECKVALID
MODI X 10 X
TEST X = 0
TJMP VALID
WIPE
HALT

MARK VALID
LINK -1
LINK -1

MARK RESTORE
TEST EOF
TJMP END

MARK END
